<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Siecia University - Music Dept.</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
  </head>
<body>
  <div class="container-fluid">
    <div class="row">

<!-- Column 1: Genre/Folder Dropdown -->
     <div class="col-3 song-list">

<!--Genre Dropdown-->
       <form method="get" onchange="this.submit()">
          <label for="genreSelect">Genre</label>
           <select id="genreSelect" name="genre" class="form-select form-select-sm mb-2">
           {% for g in genres %}
            <option value="{{ g }}" {% if g == genre %}selected{% endif %}>{{ g }}</option>
           {% endfor %}
           </select>
       </form>

<!-- available_songs_list -->
<ul class="list-unstyled">
  {% for song in songs %}
    {% set base_filename = song.filename.rsplit('/', 1)[-1] %}
    {% set clean_name = base_filename.rsplit('.', 1)[0] %}
    <li class="mb-1">
      <a href="#" class="text-decoration-none text-white d-inline-block"
         onclick='addToQueue({{ song.genre|tojson }}, {{ base_filename|tojson }}); return false;'>
        {{ clean_name }}
      </a>
    </li>
  {% else %}
    <li class="text-muted">No songs found.</li>
  {% endfor %}
</ul>

     </div><!--Close column1-->

<!-- Column 2: Video and Queue -->
     <div class="col-4 video-section">

<!-- ##### VIDEO SCREEN #### -->
     <video id="player">
        <source id="video-source" src="" type="video/mp4">
           Your browser does not support the video tag.
      </video>

<!-- #### QUEUE #### -->
        <div class="queue mt-3 overflow-auto" style="flex-grow: 1; max-height: 200px;">
         <ul id="queue-list" class="list-unstyled">
           {% for q in queue %}
           <li class="text-white song-link" style="font-size: 0.85rem;" onclick="removeFromQueue(${JSON.stringify(genre)}, ${JSON.stringify(filename)})">
             {{ q.filename.rsplit('.', 1)[0] }}
           </li>
            {% endfor %}
          </ul>
     </div>

 <!-- #### PLAYER BUTTONS #### -->
      <div class="mt-2 text-center border-top pt-2" id="media_controls">
           <button class="btn btn-warning btn-sm" onclick="previousSong()">Previous</button>
           <button class="btn btn-success btn-sm" onclick="playSong()">‚ñ∂ Play</button>
           <button class="btn btn-success btn-sm" onclick="stopPlayback()">‚èπ Stop</button>
           <button class="btn btn-warning btn-sm" onclick="restartSong()">üîÅ Start Over</button>
           <button class="btn btn-warning btn-sm" onclick="nextSong()">Next</button>
           <button class="btn btn-secondary btn-sm mt-2" onclick="window.open('/debug', '_blank')">‚öôÔ∏è</button>
      </div>

</div> <!--Close column2-->

<!-- Columns 3: Song Sheet -->
     <div class="col-5 sheet-section">
        <img src="{{ url_for('static', filename='') }}" id="sheet-display" alt="Song Sheet">
      </div> <!--Close column3-->

    </div> <!--Close class="row"-->
  </div> <!-- class="container-fluid" -->

<script>
// Needs to stay here for Python template rendering
const songs = {{ songs|tojson|safe }};
</script>
<script src="{{ url_for('static', filename='script.js') }}"></script>
</body>
</html>