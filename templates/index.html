<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Siecia University - Music Dept.</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
  <div class="container-fluid">
    <div class="row">
     <!-- Column 1: Genre/Folder Dropdown -->
       <div class="col-3 song-list">

       <form method="get" onchange="this.submit()">
          <label for="genreSelect">Genre</label>
           <select id="genreSelect" name="genre" class="form-select form-select-sm mb-2">
           {% for g in genres %}
            <option value="{{ g }}" {% if g == genre %}selected{% endif %}>{{ g }}</option>
           {% endfor %}
           </select>
       </form>

    <!-- available_songs_list -->
      <ul class="list-unstyled">
        {% for song in songs %}
        {% set name = song.filename.rsplit('.', 1)[0] %}
        <li class="song-link text-white" style="cursor: pointer;"
         onclick='addToQueue({{ song.genre|tojson }}, {{ song.filename|tojson }})'>
         {{ name }}
        </li>
        {% else %}
        <li class="text-muted">No songs found.</li>
       {% endfor %}
      </ul>
    </div>

<!-- Column 2: Video and Queue -->
    <div class="col-4 video-section">
<!-- ##### VIDEO SCREEN #### -->
      <video id="video-player" controls width="100%">
        <source id="video-source" src="" type="video/mp4">
           Your browser does not support the video tag.
      </video>

<!-- #### QUEUE #### -->
       <div class="queue mt-3">
         <!--<h6>Queue</h6>-->
        <div class="queue overflow-auto" style="flex-grow: 1; max-height: 200px;">

        <ul class="list-unstyled">
           {% for q in queue %}
           <li class="text-white song-link" style="font-size: 0.85rem;" onclick='removeFromQueue({{ q|tojson }})'>
            {{ q.rsplit('.', 1)[0] }}
           </li>
            {% endfor %}
          </ul>
        </div>


 <!-- #### PLAYER BUTTONS #### -->
       <div class="mt-2 text-center border-top pt-2">
           <button class="btn btn-warning btn-sm" onclick="previousSong()">Previous</button>
<!--            <button onclick="playSong()">‚ñ∂ Play / ‚ùö‚ùö Pause</button>-->
            <button onclick="playSong('{{ genre }}', '{{ current_song[:-4] if current_song }}')">‚ñ∂ Play</button>
            <button class="btn btn-success btn-sm" onclick="stopPlayback()">‚èπ Stop</button>
            <button class="btn btn-warning btn-sm" onclick="restartSong()">üîÅ Start Over</button>
           <button class="btn btn-warning btn-sm" onclick="nextSong()">Next</button>
           <button class="btn btn-danger btn-sm mt-2" onclick="clearQueue()">üßπ Clear Queue</button>
        </div>
       </div>
      </div>
<!-- Columns 3: Song Sheet -->
      <div class="col-5 sheet-section">
<!--        <h6>Song Sheet</h6>-->
        <img src="{{ url_for('static', filename='Chill/song.png') }}" id="sheet-display" alt="Song Sheet">
        <!-- For PDF embed: <embed src="/static/november_rain.pdf" type="application/pdf" width="100%" height="700px" />-->
      </div>
    </div>
  </div>
<script>
    #needs to stay here for python
  const songs = {{ songs|tojson }};
</script>
<script src="{{ url_for('static', filename='script.js') }}"></script>
</body>
</html>